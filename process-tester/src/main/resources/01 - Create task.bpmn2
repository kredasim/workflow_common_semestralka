<?xml version="1.0" encoding="UTF-8"?> 
<definitions id="Definition"
             targetNamespace="http://www.omg.org/bpmn20"
             typeLanguage="http://www.java.com/javaTypes"
             expressionLanguage="http://www.mvel.org/2.0"
             xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL"
             xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
             xsi:schemaLocation="http://www.omg.org/spec/BPMN/20100524/MODEL BPMN20.xsd"
             xmlns:g="http://www.jboss.org/drools/flow/gpd"
             xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI"
             xmlns:dc="http://www.omg.org/spec/DD/20100524/DC"
             xmlns:di="http://www.omg.org/spec/DD/20100524/DI"
             xmlns:tns="http://www.jboss.org/drools">

  <itemDefinition id="_ownerItem" structureRef="String" />
  <itemDefinition id="_coursesItem" structureRef="java.util.List" />
  <itemDefinition id="_enoughCreditItem" structureRef="Boolean" />

  <itemDefinition id="_988B8157-A133-41C7-B5C6-2DE98F028FF3-ownerItem" structureRef="String" />
  <itemDefinition id="_988B8157-A133-41C7-B5C6-2DE98F028FF3-coursesItem" structureRef="java.util.List" />
  <itemDefinition id="_988B8157-A133-41C7-B5C6-2DE98F028FF3-enoughCreditItem" structureRef="Boolean" />

  <itemDefinition id="_264E3FCB-B74B-41BE-A62D-606697A52B40_multiInstanceItemType" />

  <process processType="Private" isExecutable="true" id="industry.impl.CreateTask" name="Create task" tns:packageName="industry.impl" >

    <!-- process variables -->
    <property id="owner" itemSubjectRef="_ownerItem"/>
    <property id="courses" itemSubjectRef="_coursesItem"/>
    <property id="enoughCredit" itemSubjectRef="_enoughCreditItem"/>

    <!-- nodes -->
    <startEvent id="_4ACB1FC1-EE6F-489E-87AF-212CF66692DD" name="" />
    <userTask id="_988B8157-A133-41C7-B5C6-2DE98F028FF3" name="01 - Enter task information" >
      <ioSpecification>
        <dataInput id="_988B8157-A133-41C7-B5C6-2DE98F028FF3_TaskNameInput" name="TaskName" />
        <inputSet>
          <dataInputRefs>_988B8157-A133-41C7-B5C6-2DE98F028FF3_TaskNameInput</dataInputRefs>
        </inputSet>
        <outputSet>
        </outputSet>
      </ioSpecification>
      <dataInputAssociation>
        <targetRef>_988B8157-A133-41C7-B5C6-2DE98F028FF3_TaskNameInput</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression">enterTaskInfo</from>
          <to xsi:type="tFormalExpression">_988B8157-A133-41C7-B5C6-2DE98F028FF3_TaskNameInput</to>
        </assignment>
      </dataInputAssociation>
      <potentialOwner>
        <resourceAssignmentExpression>
          <formalExpression>#{owner}</formalExpression>
        </resourceAssignmentExpression>
      </potentialOwner>
    </userTask>
    <scriptTask id="_3D99577B-D102-406D-8B6B-5FE97C7D1371" name="Check amount of credit" scriptFormat="http://www.java.com/java" >
      <script>System.out.println("Checking for ammount of credit");</script>
    </scriptTask>
    <exclusiveGateway id="_243A1158-ADDC-42C8-9AE5-5327419C6001" name="Lack of credit?" gatewayDirection="Diverging" />
    <intermediateThrowEvent id="_91BA75E5-17CA-4522-BBC0-03A84F69F5F1" name="Inform about low account balance" >
      <signalEventDefinition signalRef="HelloRef"/>
    </intermediateThrowEvent>
    <exclusiveGateway id="_AAF32E9E-B8AB-4215-8515-17B3E0088312" name="" gatewayDirection="Converging" />
    <scriptTask id="_92181989-B8EE-422D-9B44-A9D879A81B9B" name="Publish task" scriptFormat="http://www.java.com/java" >
      <script>System.out.println("Publishing task");</script>
    </scriptTask>
    <endEvent id="_4F7E3A27-38D9-4B8A-B8BE-DC79CFE45A68" name="Task published" />
    <subProcess id="_264E3FCB-B74B-41BE-A62D-606697A52B40" name="Subject assignment"  >
      <ioSpecification>
        <dataInput id="_264E3FCB-B74B-41BE-A62D-606697A52B40_input" name="MultiInstanceInput" />
        <inputSet/>
        <outputSet/>
      </ioSpecification>
      <dataInputAssociation>
        <sourceRef>courses</sourceRef>
        <targetRef>_264E3FCB-B74B-41BE-A62D-606697A52B40_input</targetRef>
      </dataInputAssociation>
      <multiInstanceLoopCharacteristics>
        <loopDataInputRef>_264E3FCB-B74B-41BE-A62D-606697A52B40_input</loopDataInputRef>
        <inputDataItem id="course" itemSubjectRef="_264E3FCB-B74B-41BE-A62D-606697A52B40_multiInstanceItemType"/>
      </multiInstanceLoopCharacteristics>
    <!-- nodes -->
    <callActivity id="_A9FBE33F-1FCF-4251-9FA9-9081AC1E01DF" name="02 - Assign to course" calledElement="industry.impl.AssignmentToCourse" >
      <ioSpecification>
        <dataInput id="_A9FBE33F-1FCF-4251-9FA9-9081AC1E01DF_courseInput" name="course" />
        <dataInput id="_A9FBE33F-1FCF-4251-9FA9-9081AC1E01DF_ownerInput" name="owner" />
        <inputSet>
          <dataInputRefs>_A9FBE33F-1FCF-4251-9FA9-9081AC1E01DF_courseInput</dataInputRefs>
          <dataInputRefs>_A9FBE33F-1FCF-4251-9FA9-9081AC1E01DF_ownerInput</dataInputRefs>
        </inputSet>
        <outputSet>
        </outputSet>
      </ioSpecification>
      <dataInputAssociation>
        <sourceRef>course</sourceRef>
        <targetRef>_A9FBE33F-1FCF-4251-9FA9-9081AC1E01DF_courseInput</targetRef>
      </dataInputAssociation>
      <dataInputAssociation>
        <sourceRef>owner</sourceRef>
        <targetRef>_A9FBE33F-1FCF-4251-9FA9-9081AC1E01DF_ownerInput</targetRef>
      </dataInputAssociation>
    </callActivity>
    <startEvent id="_0F886063-2131-45AD-9BD8-AE8FFE487901" name="" />
    <endEvent id="_401E8397-45CC-47C9-965B-6594F2C1C33D" name="" />
    <!-- connections -->
    <sequenceFlow id="_0F886063-2131-45AD-9BD8-AE8FFE487901-_A9FBE33F-1FCF-4251-9FA9-9081AC1E01DF" sourceRef="_0F886063-2131-45AD-9BD8-AE8FFE487901" targetRef="_A9FBE33F-1FCF-4251-9FA9-9081AC1E01DF" />
    <sequenceFlow id="_A9FBE33F-1FCF-4251-9FA9-9081AC1E01DF-_401E8397-45CC-47C9-965B-6594F2C1C33D" sourceRef="_A9FBE33F-1FCF-4251-9FA9-9081AC1E01DF" targetRef="_401E8397-45CC-47C9-965B-6594F2C1C33D" />
    </subProcess>

    <!-- connections -->
    <sequenceFlow id="_4ACB1FC1-EE6F-489E-87AF-212CF66692DD-_988B8157-A133-41C7-B5C6-2DE98F028FF3" sourceRef="_4ACB1FC1-EE6F-489E-87AF-212CF66692DD" targetRef="_988B8157-A133-41C7-B5C6-2DE98F028FF3" />
    <sequenceFlow id="_264E3FCB-B74B-41BE-A62D-606697A52B40-_3D99577B-D102-406D-8B6B-5FE97C7D1371" sourceRef="_264E3FCB-B74B-41BE-A62D-606697A52B40" targetRef="_3D99577B-D102-406D-8B6B-5FE97C7D1371" />
    <sequenceFlow id="_3D99577B-D102-406D-8B6B-5FE97C7D1371-_243A1158-ADDC-42C8-9AE5-5327419C6001" sourceRef="_3D99577B-D102-406D-8B6B-5FE97C7D1371" targetRef="_243A1158-ADDC-42C8-9AE5-5327419C6001" />
    <sequenceFlow id="_243A1158-ADDC-42C8-9AE5-5327419C6001-_91BA75E5-17CA-4522-BBC0-03A84F69F5F1" sourceRef="_243A1158-ADDC-42C8-9AE5-5327419C6001" targetRef="_91BA75E5-17CA-4522-BBC0-03A84F69F5F1" name="YES" >
      <conditionExpression xsi:type="tFormalExpression" >return enoughCredit == false;</conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="_243A1158-ADDC-42C8-9AE5-5327419C6001-_AAF32E9E-B8AB-4215-8515-17B3E0088312" sourceRef="_243A1158-ADDC-42C8-9AE5-5327419C6001" targetRef="_AAF32E9E-B8AB-4215-8515-17B3E0088312" name="NO" tns:priority="1" >
      <conditionExpression xsi:type="tFormalExpression" language="http://www.java.com/java" >return true;</conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="_91BA75E5-17CA-4522-BBC0-03A84F69F5F1-_AAF32E9E-B8AB-4215-8515-17B3E0088312" sourceRef="_91BA75E5-17CA-4522-BBC0-03A84F69F5F1" targetRef="_AAF32E9E-B8AB-4215-8515-17B3E0088312" />
    <sequenceFlow id="_AAF32E9E-B8AB-4215-8515-17B3E0088312-_92181989-B8EE-422D-9B44-A9D879A81B9B" sourceRef="_AAF32E9E-B8AB-4215-8515-17B3E0088312" targetRef="_92181989-B8EE-422D-9B44-A9D879A81B9B" />
    <sequenceFlow id="_92181989-B8EE-422D-9B44-A9D879A81B9B-_4F7E3A27-38D9-4B8A-B8BE-DC79CFE45A68" sourceRef="_92181989-B8EE-422D-9B44-A9D879A81B9B" targetRef="_4F7E3A27-38D9-4B8A-B8BE-DC79CFE45A68" />
    <sequenceFlow id="_988B8157-A133-41C7-B5C6-2DE98F028FF3-_264E3FCB-B74B-41BE-A62D-606697A52B40" sourceRef="_988B8157-A133-41C7-B5C6-2DE98F028FF3" targetRef="_264E3FCB-B74B-41BE-A62D-606697A52B40" />

  </process>

  <bpmndi:BPMNDiagram>
    <bpmndi:BPMNPlane bpmnElement="industry.impl.CreateTask" >
      <bpmndi:BPMNShape bpmnElement="_4ACB1FC1-EE6F-489E-87AF-212CF66692DD" >
        <dc:Bounds x="6" y="219" width="48" height="48" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="_988B8157-A133-41C7-B5C6-2DE98F028FF3" >
        <dc:Bounds x="105" y="203" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="_3D99577B-D102-406D-8B6B-5FE97C7D1371" >
        <dc:Bounds x="540" y="203" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="_243A1158-ADDC-42C8-9AE5-5327419C6001" >
        <dc:Bounds x="706" y="212" width="48" height="48" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="_91BA75E5-17CA-4522-BBC0-03A84F69F5F1" >
        <dc:Bounds x="816" y="120" width="30" height="30" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="_AAF32E9E-B8AB-4215-8515-17B3E0088312" >
        <dc:Bounds x="917" y="212" width="48" height="48" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="_92181989-B8EE-422D-9B44-A9D879A81B9B" >
        <dc:Bounds x="1011" y="196" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="_4F7E3A27-38D9-4B8A-B8BE-DC79CFE45A68" >
        <dc:Bounds x="1133" y="205" width="48" height="48" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="_264E3FCB-B74B-41BE-A62D-606697A52B40" >
        <dc:Bounds x="255" y="173" width="238" height="140" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="_A9FBE33F-1FCF-4251-9FA9-9081AC1E01DF" >
        <dc:Bounds x="69" y="30" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="_0F886063-2131-45AD-9BD8-AE8FFE487901" >
        <dc:Bounds x="6" y="46" width="48" height="48" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="_401E8397-45CC-47C9-965B-6594F2C1C33D" >
        <dc:Bounds x="187" y="44" width="48" height="48" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge bpmnElement="_0F886063-2131-45AD-9BD8-AE8FFE487901-_A9FBE33F-1FCF-4251-9FA9-9081AC1E01DF" >
        <di:waypoint x="-225" y="-103" />
        <di:waypoint x="-136" y="-103" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="_A9FBE33F-1FCF-4251-9FA9-9081AC1E01DF-_401E8397-45CC-47C9-965B-6594F2C1C33D" >
        <di:waypoint x="-136" y="-103" />
        <di:waypoint x="-44" y="-105" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="_4ACB1FC1-EE6F-489E-87AF-212CF66692DD-_988B8157-A133-41C7-B5C6-2DE98F028FF3" >
        <di:waypoint x="30" y="243" />
        <di:waypoint x="155" y="243" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="_264E3FCB-B74B-41BE-A62D-606697A52B40-_3D99577B-D102-406D-8B6B-5FE97C7D1371" >
        <di:waypoint x="374" y="243" />
        <di:waypoint x="590" y="243" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="_3D99577B-D102-406D-8B6B-5FE97C7D1371-_243A1158-ADDC-42C8-9AE5-5327419C6001" >
        <di:waypoint x="590" y="243" />
        <di:waypoint x="674" y="243" />
        <di:waypoint x="674" y="236" />
        <di:waypoint x="730" y="236" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="_243A1158-ADDC-42C8-9AE5-5327419C6001-_91BA75E5-17CA-4522-BBC0-03A84F69F5F1" >
        <di:waypoint x="730" y="236" />
        <di:waypoint x="730" y="135" />
        <di:waypoint x="831" y="135" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="_243A1158-ADDC-42C8-9AE5-5327419C6001-_AAF32E9E-B8AB-4215-8515-17B3E0088312" >
        <di:waypoint x="730" y="236" />
        <di:waypoint x="941" y="236" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="_91BA75E5-17CA-4522-BBC0-03A84F69F5F1-_AAF32E9E-B8AB-4215-8515-17B3E0088312" >
        <di:waypoint x="831" y="135" />
        <di:waypoint x="941" y="135" />
        <di:waypoint x="941" y="236" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="_AAF32E9E-B8AB-4215-8515-17B3E0088312-_92181989-B8EE-422D-9B44-A9D879A81B9B" >
        <di:waypoint x="941" y="236" />
        <di:waypoint x="1061" y="236" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="_92181989-B8EE-422D-9B44-A9D879A81B9B-_4F7E3A27-38D9-4B8A-B8BE-DC79CFE45A68" >
        <di:waypoint x="1061" y="236" />
        <di:waypoint x="1157" y="229" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="_988B8157-A133-41C7-B5C6-2DE98F028FF3-_264E3FCB-B74B-41BE-A62D-606697A52B40" >
        <di:waypoint x="155" y="243" />
        <di:waypoint x="374" y="243" />
      </bpmndi:BPMNEdge>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>

</definitions>